<!doctype html>
<html prefix="og: http://ogp.me/ns#" lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>M</title>
        <meta name="description" content="Martin's photo website - photography of nature, architecture, people.">

        <meta property="og:type" content="website" />
        <meta property="og:title" content="M Photo" />
        <meta property="og:description" content="Photography of nature, architecture, people." />
        <meta property="og:url" content="http://martinkz.eu/photo/" />
        <meta property="og:image" content="http://martinkz.eu/photo/assets/m-logo_fb.png" />

        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="apple-touch-icon" href="assets/apple-touch-icon.png">
        
        <link href='http://fonts.googleapis.com/css?family=Roboto:100,300' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="css/main.css">
        
        <!--[if lt IE 9]>
            <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
            <script>window.html5 || document.write('<script src="assets/html5shiv.js"><\/script>')</script> 
        <![endif]-->
    </head>
    <body>

        <nav role="navigation">
            <a id="m-logo" href="index.html" class="m-logo" title="Home">
                <img class="" src="assets/logo-m.png" alt="M Photography Logo"></a>
            
            <button id="js-hamburger" class="hamburger" aria-label="Open Menu" aria-controls="main-nav" aria-expanded="false">
                <div class="hamburger__inner"></div>
            </button>
            
            <div id="main-nav" class="modal" role="dialog" aria-label="Main Menu">
                <div class="modal__inner">
                    <a data-menu-cat="street" class="menu_item js-menu-item" href="#">Street</a>
                    <a data-menu-cat="arch" class="menu_item js-menu-item" href="#">Architecture</a>
                    <a data-menu-cat="nature" class="menu_item js-menu-item" href="#">Nature</a>
                    <a data-menu-cat="people" class="menu_item js-menu-item" href="#">People</a>
                </div>
            </div>
        </nav>
        
        <div class="bg-main-vid">
            <video id="bgvid" autoplay loop poster="assets/poster.jpg" aria-hidden="true">
                <source src="assets/bgvid.webm" type="video/webm">
                <source src="assets/bgvid.mp4" type="video/mp4">
            </video>
        </div>
        
        <main role="main">

            <div id="js-photo-large-box" class="photo-large-box" href="#" tabindex="0" aria-label="photograph">
                <img id="js-photo-large" src="" alt="">
            </div>
            
            <section id="js-photo-section" class="photo-section hidden">
                <h2 id="js-cat-title" class="cat-title"></h2>
            </section>

        </main>
		
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.3/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="assets/jquery-2.2.3.min.js"><\/script>')</script>

		
        <script>
        $(document).ready(function()
        {

            // INIT STUFF

            $('#m-logo').attr('tabindex', '-1');

            setTimeout(function(){ 
                $('.bg-main-vid').addClass('bg-main-vid--visible'); 
            }, 0);

            var bgvid = document.getElementsByTagName("video")[0];
            bgvid.play();

            // MAIN MENU ( MODAL / HAMBURGER FUNCTIONALITY )

            var gallery_active = false;
            var menu_active = false;
            
            var toggleMenuFunctionality = function()
            {
                $('#js-hamburger').toggleClass('hamburger--open');
                $('.modal').toggleClass('modal--visible');
                
                menu_active = $("#js-hamburger").hasClass('hamburger--open');
                
                if(menu_active) // opening menu
                { 
                    $('#js-hamburger').attr('aria-label', 'Close Menu');
                    $('#js-hamburger').attr('aria-expanded', 'true');
                    $('#m-logo').addClass('m-logo--in_header');
                    $('#m-logo').attr('tabindex', '0');
                    $('.bg-main-vid').addClass('hidden');
                    $('.photo-section').addClass('hidden');
                    bgvid.pause();
                } 
                else // closing menu
                {
                    $('#js-hamburger').attr('aria-label', 'Open Menu');
                    $('#js-hamburger').attr('aria-expanded', 'false');
                    if(gallery_active){
                        $('.photo-section').removeClass('hidden'); 
                    }
                    else 
                    {
                        $('.photo-section').addClass('hidden');
                        $('#m-logo').removeClass('m-logo--in_header');
                        $('#m-logo').attr('tabindex', '-1');
                        $('.bg-main-vid').removeClass('hidden');
                        bgvid.play();
                    }
                }
            }
            
            $('#js-hamburger').click(function(e) {
                toggleMenuFunctionality();
                // fadeOut first checks whether the element is hidden to avoid unnecessary DOM manipulation
                $('#js-photo-large-box').fadeOut(200); 
            });

            //var img_loaded = {};
            
            $('.js-menu-item').click(function(e) 
            {
                e.preventDefault();
                var s_cat = $(this).attr('data-menu-cat');
                gallery_active = true;
                toggleMenuFunctionality();
                
                photoGallery.render(s_cat); 

                $('.photo-box:not(.hidden):first .js-photo-link').focus();
                $('.bg-main-vid').addClass('hidden');
                $('#js-cat-title').text( $(this).text() );
            });

            // HOME LINK
            
            $('#m-logo').click(function(e) 
            {
                e.preventDefault();
                gallery_active = false;
                $('#m-logo').removeClass('m-logo--in_header');
                $('#m-logo').attr('tabindex', '-1');
                if(menu_active) toggleMenuFunctionality();
                $('.bg-main-vid').removeClass('hidden');
                $('.photo-box').addClass('hidden');
                $('.photo-section').addClass('hidden');
                $('#js-photo-large-box').fadeOut(200);
                bgvid.play();
            });

            // TAB KEY FUNCTIONALITY

            var tab_items = '#js-hamburger, #m-logo, .js-menu-item, .js-photo-link, .js-map-location, #js-photo-large-box';

            $(tab_items).keyup(function (e) {
                if ((e.keyCode || e.which) == 9) $(this).addClass('has-tab-focus');
            });

            $(tab_items).blur(function() {
                $(this).removeClass('has-tab-focus');
            });
            
            // GALLERY FUNCTIONALITY

            var photoData = {
                'arch' : [
                    {
                        filename : "DSC00343-2.jpg",
                        location : "https://www.google.com/maps/place/Tsarevets/@43.0837812,25.6520446,15z/data=!4m5!3m4!1s0x0:0x9a3dd95d468c59c4!8m2!3d43.0837812!4d25.6520446",
                        cssClass : "color--tsarevets",
                        title : "Tsarevets Castle"
                    },{
                        filename : "DSC03354.jpg",
                        location : "https://www.google.com/maps/place/Assen's+Fortress,+86,+4230,+Bulgaria/@41.9866573,24.8614335,15.54z/data=!4m5!3m4!1s0x14acdf314ac0cb81:0x7dcdeb016a88a92e!8m2!3d41.9862893!4d24.8742939",
                        cssClass : "color--asen",
                        title : "Asen's Fortress"
                    },{
                        filename : "DSC08611.jpg",
                        location : "https://www.google.com/maps/place/Canary+Wharf,+London,+UK/@51.5053536,-0.0254861,16z/data=!3m1!4b1!4m5!3m4!1s0x487602ba7a12992f:0x4d821857a5e4a41!8m2!3d51.5054306!4d-0.0235333",
                        cssClass : "color--canary",
                        title : "Canary Wharf"
                    },{
                        filename : "DSC08687-2.jpg",
                        location : "https://www.google.com/maps/place/Leadenhall+Market/@51.5127764,-0.0857301,17z/data=!3m1!4b1!4m5!3m4!1s0x487603528c761b51:0x2ab521a67e1111b3!8m2!3d51.5127731!4d-0.0835414",
                        cssClass : "color--leadenhall",
                        title : "Leadenhall Market"
                    },{
                        filename : "DSC08706-2.jpg",
                        location : "https://www.google.com/maps/place/The+Shard/@51.5045033,-0.0886887,17z/data=!3m1!4b1!4m5!3m4!1s0x4876035a0a9271d3:0xbdf26ba73efb7b!8m2!3d51.5045!4d-0.0865",
                        cssClass : "color--shard",
                        title : "The Shard"
                    },{
                        filename : "DSC01816_2.jpg",
                        location : "https://www.google.com/maps/place/Tsarevets/@43.0837812,25.6520446,15z/data=!4m5!3m4!1s0x0:0x9a3dd95d468c59c4!8m2!3d43.0837812!4d25.6520446",
                        cssClass : "color--tsarevetsnight",
                        title : "Tsarevets Castle at Night"
                    },{
                        filename : "DSC08738.jpg",
                        location : "https://www.google.com/maps/place/More+London+Riverside,+London+SE1,+UK/@51.5049969,-0.0838736,17z/data=!3m1!4b1!4m5!3m4!1s0x487603500e445477:0x1c7ec4e9f2ff809b!8m2!3d51.5049936!4d-0.0816849",
                        cssClass : "color--morelondon",
                        title : "More London Riverside"
                    },{
                        filename : "DSC08701-2.jpg",
                        location : "https://www.google.com/maps/place/20+Fenchurch+Street/@51.5110245,-0.0856419,17z/data=!3m1!4b1!4m5!3m4!1s0x4876034da993f3fb:0xb252389db2d35c67!8m2!3d51.5110212!4d-0.0834532",
                        cssClass : "color--20fenchurch",
                        title : "20 Fenchurch Street"
                    },{
                        filename : "DSC05511-2.jpg",
                        location : "https://www.google.com/maps/place/Bankside+Pier/@51.5087443,-0.0974469,18z/data=!3m1!4b1!4m5!3m4!1s0x487604a99c2696a1:0x28b86d6fa6fd8de0!8m2!3d51.508743!4d-0.096603",
                        cssClass : "color--bankside",
                        title : "Bankside View"
                    },{
                        filename : "DSC08617.jpg",
                        location : "https://www.google.com/maps/place/J.P.+Morgan/@51.5038201,-0.0193993,17.17z/data=!4m5!3m4!1s0x0000000000000000:0x7901d4ddebf1e959!8m2!3d51.5030428!4d-0.0203526",
                        cssClass : "color--jpmorgan",
                        title : "J. P. Morgan building"
                    },{
                        filename : "DSC09830_2.jpg",
                        location : "https://www.google.com/maps/place/Southwark+Cathedral/@51.5061042,-0.0917845,17z/data=!3m1!4b1!4m5!3m4!1s0x487603571183a4d5:0x1e6e505ff27f7772!8m2!3d51.5061009!4d-0.0895958!6m1!1e1",
                        cssClass : "color--oldandnew",
                        title : "Old &amp; New"
                    }
                ],'street' : [
                    {
                        filename : "DSC00349.jpg",
                        cssClass : "color--cat",
                        title : "Black Street Cat"
                    },{
                        filename : "DSC00763-2.jpg",
                        location : "https://www.google.com/maps/place/Park+Hill+Park/@51.3707857,-0.0940061,17z/data=!3m1!4b1!4m5!3m4!1s0x487600cb1f032ce5:0x3c6012c82d89b0f5!8m2!3d51.3707824!4d-0.0918174!6m1!1e1",
                        cssClass : "color--parkhill",
                        title : "Park Hill in the spring"
                    },{
                        filename : "DSC04036.jpg",
                        location : "https://www.google.com/maps/place/Southbank+Centre/@51.5057831,-0.1188808,17z/data=!3m1!4b1!4m5!3m4!1s0x487604b7e7c78711:0xa1ed79798fdff99!8m2!3d51.5057798!4d-0.1166921!6m1!1e1",
                        cssClass : "color--carousel",
                        title : "The South Bank Carousel"
                    },{
                        filename : "DSC04249.jpg",
                        location : "https://www.google.com/maps/place/Jubilee+Gardens/@51.5037757,-0.1205264,17z/data=!3m1!4b1!4m5!3m4!1s0x487604c7eeb058b3:0x2ed43bbc432e41d4!8m2!3d51.5037724!4d-0.1183377!6m1!1e1",
                        cssClass : "color--eyeskate",
                        title : "Eyeskate at London Eye"
                    },{
                        filename : "DSC04647.jpg",
                        location : "https://www.google.com/maps/place/Big+Ben/@51.5007325,-0.1268141,17z/data=!3m1!4b1!4m5!3m4!1s0x487604c38c8cd1d9:0xb78f2474b9a45aa9!8m2!3d51.5007292!4d-0.1246254!6m1!1e1",
                        cssClass : "color--bigbensunset",
                        title : "Big Ben at sunset"
                    },{
                        filename : "DSC04818.jpg",
                        location : "https://www.google.com/maps/place/High+Street+Kensington+Station/@51.5010254,-0.1949251,17z/data=!3m1!4b1!4m5!3m4!1s0x48760ff6c4a82b49:0x585a2ea24735a80b!8m2!3d51.5010221!4d-0.1927364!6m1!1e1",
                        cssClass : "color--kensingtontube",
                        title : "High Street Kensington"
                    },{
                        filename : "DSC05268.jpg",
                        location : "https://www.google.com/maps/place/King+St,+London+WC2E+8HN,+UK/@51.5120407,-0.1262272,17.58z/data=!4m5!3m4!1s0x487604d18fe91ce3:0x49bd96b347de6d85!8m2!3d51.5116526!4d-0.1244363",
                        cssClass : "color--kingstr",
                        title : "King St at Christmas"
                    },{
                        filename : "DSC05522.jpg",
                        location : "https://www.google.com/maps/place/Millennium+Bridge/@51.5095324,-0.1007312,17z/data=!3m1!4b1!4m5!3m4!1s0x487604abcc128291:0xbd5ceafc2f514e1c!8m2!3d51.5095291!4d-0.0985425",
                        cssClass : "color--milbridge",
                        title : "Millennium Bridge"
                    },{
                        filename : "DSC06523.jpg",
                        location : "https://www.google.com/maps/place/Green+Park/@51.503905,-0.1460481,17z/data=!3m1!4b1!4m5!3m4!1s0x4876052881ff2bd9:0xdb5ab148cad5f1a3!8m2!3d51.5039017!4d-0.1438594",
                        cssClass : "color--greenpark",
                        title : "Green Park"
                    },{
                        filename : "DSC07351.jpg",
                        location : "https://www.google.com/maps/place/Westminster+Pier/@51.5022585,-0.1249692,17z/data=!3m1!4b1!4m5!3m4!1s0x487604b5e5fa5013:0xd126c7fee870cd40!8m2!3d51.5022558!4d-0.1231811",
                        cssClass : "color--nye2",
                        title : "New Year's Eve Fireworks"
                    },{
                        filename : "DSC01344.jpg",
                        location : "https://www.google.com/maps/place/Blackfriars+Millennium+Pier/@51.5107682,-0.1088308,17z/data=!3m1!4b1!4m5!3m4!1s0x487604b20a893427:0x4ea46251e06dcb4!8m2!3d51.5107649!4d-0.1066421",
                        cssClass : "color--thamessunset",
                        title : "Ship on the Thames"
                    },{
                        filename : "DSC04239.jpg",
                        location : "https://www.google.com/maps/place/Monument+Asenevtsi/@43.0825698,25.6354304,17z/data=!3m1!4b1!4m5!3m4!1s0x40a92619660c62fb:0x28cf66ea959ff989!8m2!3d43.0825659!4d25.6376191",
                        cssClass : "color--asenevtsi",
                        title : "Asenevtsi Monument"
                    },{
                        filename : "DSC00437.jpg",
                        location : "https://www.google.com/maps/place/Admiralty+Arch/@51.5067931,-0.1308471,17z/data=!3m1!4b1!4m5!3m4!1s0x48761be37a08548f:0x8c2c4c72fe80030d!8m2!3d51.5067898!4d-0.1286584",
                        cssClass : "color--admiralty",
                        title : "Admiralty Arch"
                    },{
                        filename : "DSC07374.jpg",
                        location : "https://www.google.com/maps/place/Westminster+Pier/@51.5022585,-0.1249692,17z/data=!3m1!4b1!4m5!3m4!1s0x487604b5e5fa5013:0xd126c7fee870cd40!8m2!3d51.5022558!4d-0.1231811",
                        cssClass : "color--nye1",
                        title : "New Year's Eve Fireworks"
                    },{
                        filename : "DSC00882.jpg",
                        cssClass : "color--firedancing",
                        title : "Fire dancing"
                    },{
                        filename : "DSC00553_3.jpg",
                        location : "https://www.google.com/maps/place/Veliko+Tarnovo,+Bulgaria/@43.0841301,25.5981031,13z/data=!3m1!4b1!4m5!3m4!1s0x40a9214b3d9491dd:0x400a01269bf5dc0!8m2!3d43.0756739!4d25.6171514",
                        cssClass : "color--vt1",
                        title : "Veliko Tarnovo"
                    },{
                        filename : "DSC00960.jpg",
                        cssClass : "color--firedancing2",
                        title : "Fire dancing"
                    },{
                        filename : "DSC01778.jpg",
                        cssClass : "color--lumiereart",
                        title : "Art installation"
                    },{
                        filename : "DSC01785.jpg",
                        location : "https://www.google.com/maps/place/Ganton+St,+Soho,+London,+UK/@51.5131292,-0.1409391,17z/data=!3m1!4b1!4m5!3m4!1s0x487604d51a725e2d:0x98cdd619015cf8e2!8m2!3d51.5131259!4d-0.1387504",
                        cssClass : "color--morelondon",
                        title : "Ganton Street"
                    },{
                        filename : "DSC02368_2.jpg",
                        cssClass : "color--towerbridge",
                        title : "Martini"
                    },{
                        filename : "DSC08761-4.jpg",
                        location : "https://www.google.com/maps/place/The+Scoop/@51.5053567,-0.0813937,18z/data=!3m1!4b1!4m5!3m4!1s0x4876034f9245ce1f:0xc41ba1b462523a57!8m2!3d51.505355!4d-0.0802994",
                        cssClass : "color--towerbridge",
                        title : "Tower Bridge"
                    },{
                        filename : "DSC04245.jpg",
                        location : "https://www.google.com/maps/place/London+Eye/@51.5033273,-0.1217317,17z/data=!3m1!4b1!4m5!3m4!1s0x487604b900d26973:0x4291f3172409ea92!8m2!3d51.503324!4d-0.119543",
                        cssClass : "color--londoneye",
                        title : "The London Eye"
                    },{
                        filename : "DSC07260_2.jpg",
                        location : "https://www.google.com/maps/place/Bern,+Switzerland/@46.9547232,7.3598507,13z/data=!3m1!4b1!4m5!3m4!1s0x478e39c0d43a1b77:0xcb555ffe0457659a!8m2!3d46.9479739!4d7.4474468",
                        cssClass : "color--bern",
                        title : "Bern"
                    },{
                        filename : "DSC03213_2.jpg",
                        location : "https://www.google.com/maps/place/%D0%A6%D1%8A%D1%80%D0%BA%D0%B2%D0%B0+%22%D0%A1%D0%B2.+%D0%94%D0%B8%D0%BC%D0%B8%D1%82%D1%8A%D1%80+%D0%A1%D0%BE%D0%BB%D1%83%D0%BD%D1%81%D0%BA%D0%B8%22/@43.0879324,25.6460754,17z/data=!4m5!3m4!1s0x40a928a03b00fe97:0x40898cdcf95e4322!8m2!3d43.0879207!4d25.6482963",
                        cssClass : "color--vt2",
                        title : "St Demetrius church, <br>Veliko Tarnovo"
                    },{
                        filename : "DSC01091_2.jpg",
                        cssClass : "color--bowl",
                        title : "Wooden Bowl"
                    }
                ], 'nature' : [
                    {
                        filename : "DSC01091.jpg",
                        cssClass : "color--parakeet1",
                        title : "Ring-necked parakeet #1"
                    },{
                        filename : "DSC01103.jpg",
                        cssClass : "color--parakeet2",
                        title : "Ring-necked parakeet #2"
                    },{
                        filename : "DSC01097.jpg",
                        cssClass : "color--parakeet3",
                        title : "Ring-necked parakeet #3"
                    },{
                        filename : "DSC00059.jpg",
                        cssClass : "color--owl1",
                        title : "Young Owl"
                    },{
                        filename : "DSC00027.jpg",
                        cssClass : "color--ilikegreen",
                        title : "&quot;I like green&quot;"
                    },{
                        filename : "DSC07404.jpg",
                        cssClass : "color--stars",
                        title : "Stars"
                    },{
                        filename : "DSC03377.jpg",
                        location : "https://www.google.com/maps/place/Lake+Thun/@46.7004466,7.693371,13z/data=!3m1!4b1!4m5!3m4!1s0x478fae3554ddf6eb:0xc692ca79d2500aea!8m2!3d46.6958354!4d7.7212158",
                        cssClass : "color--interlaken",
                        title : "Interlaken, Switzerland"
                    },{
                        filename : "DSC03470.jpg",
                        location : "https://www.google.com/maps/place/Spl%C3%BCgen,+Switzerland/@46.5419936,9.2730908,13z/data=!3m1!4b1!4m5!3m4!1s0x4784f13d6aedbcfd:0xf1aadd833303743!8m2!3d46.5528268!4d9.3233581",
                        cssClass : "color--splugen1",
                        title : "Splügen, Switzerland"
                    },{
                        filename : "DSC03477.jpg",
                        location : "https://www.google.com/maps/place/Spl%C3%BCgen,+Switzerland/@46.5419936,9.2730908,13z/data=!3m1!4b1!4m5!3m4!1s0x4784f13d6aedbcfd:0xf1aadd833303743!8m2!3d46.5528268!4d9.3233581",
                        cssClass : "color--splugen2",
                        title : "Splügen, Switzerland"
                    },{
                        filename : "DSC03534_1.jpg",
                        cssClass : "color--roadsplugen",
                        title : "Road near Splügen"
                    },{
                        filename : "DSC04007.jpg",
                        location : "https://www.google.com/maps/place/Ballenberg,+Swiss+Open-Air+Museum/@46.6288304,8.053599,10.88z/data=!4m5!3m4!1s0x478f9134298b85dd:0x1b2939447bd25159!8m2!3d46.7496093!4d8.0857353",
                        cssClass : "color--ballenberg",
                        title : "Ballenberg"
                    },{
                        filename : "DSC04721_3-HDR.jpg",
                        location : "https://www.google.com/maps/place/Lugano,+Switzerland/@46.0295228,8.9247653,12z/data=!3m1!4b1!4m5!3m4!1s0x47842df76a4211f1:0xef8c04212ea1f8e0!8m2!3d46.0036778!4d8.951052",
                        cssClass : "color--lugano",
                        title : "Near Lugano"
                    },{
                        filename : "DSC07081_2.jpg",
                        location : "https://www.google.com/maps/place/Sandy+Bay,+Exmouth,+Devon,+UK/@50.6156499,-3.3862672,13.54z/data=!4m5!3m4!1s0x486d7549638311b5:0xbecac8a6021b1136!8m2!3d50.6172316!4d-3.3649063",
                        cssClass : "color--jurassic",
                        title : "The Jurassic Coast"
                    },{
                        filename : "DSC07302_2.jpg",
                        location : "https://www.google.com/maps/place/Hound+Tor/@50.6000184,-3.8227894,12.54z/data=!4m5!3m4!1s0x486cffdfe5332c95:0x5a76d7f0711197ef!8m2!3d50.5969615!4d-3.7779772",
                        cssClass : "color--houndtor",
                        title : "Hound Tor, Dartmoor"
                    },{
                        filename : "DSC07475.jpg",
                        cssClass : "color--owl2",
                        title : "Owl"
                    },{
                        filename : "DSC01052.jpg",
                        cssClass : "color--goldfinch",
                        title : "European goldfinch"
                    },{
                        filename : "DSC07525.jpg",
                        cssClass : "color--owl3",
                        title : "More owl"
                    },{
                        filename : "DSC09379.jpg",
                        cssClass : "color--flower",
                        title : "Flower"
                    },{
                        filename : "DSC09957.jpg",
                        location : "https://www.google.com/maps/place/Richmond+Park/@51.4426902,-0.2858957,17z/data=!3m1!4b1!4m5!3m4!1s0x48760ea56197d1fd:0x138cbe1a5a3a048d!8m2!3d51.4426869!4d-0.283707",
                        cssClass : "color--richmond",
                        title : "Richmond Park"
                    },{
                        filename : "DSC09960.jpg",
                        cssClass : "color--bateleur",
                        title : "Bateleur Eagle"
                    },{
                        filename : "DSC09461.jpg",
                        cssClass : "color--squirrel1",
                        title : "Curious Squirrel"
                    },{
                        filename : "DSC09940.jpg",
                        cssClass : "color--owl4",
                        title : "Yet another owl"
                    },{
                        filename : "DSC09420.jpg",
                        cssClass : "color--squirrel2",
                        title : "Mr. Squirrel"
                    }
                ], 'people' : [
                    {
                        cssClass : "color--people1",
                        filename : "DSC07127-3.jpg"
                    },{
                        cssClass : "color--people2",
                        filename : "DSC00284.jpg"
                    },{
                        cssClass : "color--people3",
                        filename : "DSC00370.jpg"
                    },{
                        cssClass : "color--people4",
                        filename : "DSC00446.jpg"
                    },{
                        cssClass : "color--people5",
                        filename : "DSC01252_2.jpg"
                    },{
                        cssClass : "color--people17",
                        filename : "DSC08387.jpg"
                    },{
                        cssClass : "color--people7",
                        filename : "DSC01343_2.jpg"
                    },{
                        cssClass : "color--people8",
                        filename : "DSC02129.jpg"
                    },{
                        cssClass : "color--people16",
                        filename : "DSC04339.jpg"
                    },{
                        cssClass : "color--people13",
                        filename : "DSC03322-2.jpg"
                    },{
                        cssClass : "color--people6",
                        filename : "DSC01318.jpg"
                    },{
                        cssClass : "color--people11",
                        filename : "DSC03231.jpg"
                    },{
                        cssClass : "color--people12",
                        filename : "DSC03263.jpg"
                    },{
                        cssClass : "color--people19",
                        filename : "DSC05200.jpg"
                    },{
                        cssClass : "color--people20",
                        filename : "DSC05672.jpg"
                    },{
                        cssClass : "color--people9",
                        filename : "DSC02943.jpg"
                    },{
                        cssClass : "color--people18",
                        filename : "DSC04397_2.jpg"
                    },{
                        cssClass : "color--people21",
                        filename : "DSC05983-2.jpg"
                    },{
                        cssClass : "color--people14",
                        filename : "DSC03372-2.jpg"
                    }
                ]
            };

            var galleryModel = {

                paths : {
                    'sm' : 'images/small/',
                    'md' : 'images/medium/',
                    'lg' : 'images/large/' 
                },
                photos : photoData,

                getCats : function() {
                    return Object.keys(this.photos);
                },
                getPhotos : function(cat) {
                    return this.photos[cat];
                },
                getPath : function(type) {
                    return this.paths[type];
                }
            };


            var photoCardView = {
                // Could be replaced with a mustache template some day
                buildHTML: function(card, cat) {
                    return '' +
                    '<div class="photo-box ' + (!card.title ? card.cssClass : '') + ' hidden">' + 
                    	'<div class="photo-box__inner">' + 
                    		'<a class="photo-link js-photo-link" href="' + galleryModel.getPath('lg') + card.filename + '">' + 
                                // to remove data-cat later if not needed
                    			'<img data-cat="' + cat + '" src="' + galleryModel.getPath('sm') + card.filename + '" alt="' + card.title + '">' +
                    		'</a>' + 
                    		(card.location ? '<a class="map-location js-map-location" target="_blank" href="' + card.location + '"></a>' : '') +
                    	'</div>' + 
                    	(card.title ? '<h2 class="photo-title ' + card.cssClass + '">' + card.title + '</h2>' : '') +
                    '</div>';
                }
            };

            var photoGalleryView = function(container) {

                var _cardDOMrefs = {};
                var _prevCat;

                galleryModel.getCats().forEach( function(cat) {
                    _cardDOMrefs[cat] = [];
                });

                function catExists(cat) {
                    return _cardDOMrefs.hasOwnProperty(cat);
                }

                function catLoaded(cat) {
                    return (catExists(cat) && _cardDOMrefs[cat].length > 0);
                };

                function initCards(cat) {
                    galleryModel.getPhotos(cat).forEach( function(card) {

                        var cardDOMref = $( photoCardView.buildHTML(card, cat) );
                        
                        cardDOMref.on('click', function(e) {
                            e.preventDefault();
                            lightbox.show(card);
                        });

                        cardDOMref.find('.js-map-location').on('click', function(e){
                            e.stopPropagation();
                        })

                        _cardDOMrefs[cat].push(cardDOMref);
                    });

                     $(container).append(_cardDOMrefs[cat]);
                     console.log(cat);
                };

                this.render = function(newCat) {

                    if(_prevCat && _prevCat !== newCat) {
                        _cardDOMrefs[_prevCat].forEach( function(card) {
                            card.addClass('hidden');
                        });
                    }

                    if( !catExists(newCat) ) return;

                    if( !catLoaded(newCat) ) initCards(newCat);

                    _cardDOMrefs[newCat].forEach( function(card) {
                        card.removeClass('hidden');
                    })

                    _prevCat = newCat;
                }
            };

            var photoGallery = new photoGalleryView('#js-photo-section');


            var photoLightbox = function(el) {

                var cur_scroll;
                var container = $(el);
                var image = $(el + ' img');

                container.hide();

                var highDPR = window.devicePixelRatio ? window.devicePixelRatio >= 1.5 ? 1 : 0 : 0;

                // To be replaced with srcset once object-fit works in Edge
                function generate_resp_path() {
                    var ww = window.innerWidth;
                    var wh = window.innerHeight;

                    if(ww <= 660 && wh <= 660) {
                        return highDPR ? galleryModel.getPath('md') : galleryModel.getPath('sm');
                    }
                    else if (ww <= 1200 && wh <= 1200) {
                        return highDPR ? galleryModel.getPath('lg') : galleryModel.getPath('md');
                    }
                    else return galleryModel.getPath('lg');
                }

                this.show = function(card) {
                    image.attr('src', generate_resp_path() + card.filename);
                    container.fadeIn(200);
                    container.focus();

                    cur_scroll = $(document).scrollTop();

                    $('.photo-section').addClass('hidden');
                                  
                    if(history.state===null || history.state.cur_page!="photo") { 
                        history.pushState({cur_page: "photo"}, null, null);
                    }
                }

                this.hide = function() {
                    container.fadeOut(200, function(){
                        image.attr('src', '');
                    });
                    
                    $('.photo-section').removeClass('hidden');

                    $(document).scrollTop(cur_scroll);
                }

                var that = this;

                container.on('click', function(e) {
                    that.hide();
                });

                container.on('keyup', function(e) {
                    if (e.keyCode == 27) that.hide();
                });
                
                window.addEventListener("popstate", function(event) {
                    that.hide();
                });
            }

            var lightbox = new photoLightbox('#js-photo-large-box');
            
        });
        </script>
        
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
          ga('create', 'UA-77805584-1', 'auto');
          ga('send', 'pageview');
        </script>

    </body>
</html>
